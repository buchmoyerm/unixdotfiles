set nocompatible              " be iMproved, required

if filereadable(expand("~/.vimrc.plugins"))
    source ~/.vimrc.plugins
endif

""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" => Hack to get alt-alpha keys to work in terminal
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

function! Alt_hack_char(ch) abort
  exec "set <A-".a:ch.">=\e".a:ch
  exec "imap \e".a:ch." <A-".a:ch.">"
endfunction

" alt+alpha
let c='a'
while c <= 'z'
  call Alt_hack_char(c)
  let c = nr2char(1+char2nr(c))
endw

call Alt_hack_char('\')

"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" => peekaboo command line hack
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

if !has("gui_running")
  function! s:Peekaboo()
    call peekaboo#peek(1, 'ctrl-r',  0)
  endfunction

  let g:Cmd2_cmd_mappings = {
      \ 'Peekaboo': {'command': function('s:Peekaboo'), 'type': 'function'},
      \ }

  cmap <C-R> <Plug>(Cmd2)Peekaboo

endif

syntax on

"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" => min settings
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
colorscheme molokai
let g:rehash256 = 1

" let comma be used as map leader
let mapleader=","
map \ ,

" quickly exit insert mode without esc
inoremap fj <Esc>
vnoremap fj <Esc>
snoremap fj <Esc>

" more natural navigation of log lines with word wrap
nnoremap j gj
nnoremap k gk

" highlight all matched under cursor but don't jump to next match
nnoremap * :keepjumps normal! mi*`i<CR>

" switch between paste modes (use unimpaired co* style)
" event though tpope disagrees with paste mode having shortcut
" tpope probably doesn't use putty like I am.
nnoremap cop :set paste!<CR>

let g:tmux_navigator_disable_when_zoomed = 1
let g:tmux_navigator_no_mappings = 1
let g:tmux_navigator_save_on_switch = 1
noremap <silent> <M-h> :TmuxNavigateLeft<cr>
noremap <silent> <M-j> :TmuxNavigateDown<cr>
noremap <silent> <M-k> :TmuxNavigateUp<cr>
noremap <silent> <M-l> :TmuxNavigateRight<cr>
noremap <silent> <M-\> :TmuxNavigatePrevious<cr>

tnoremap <silent> <M-h> <C-w>:TmuxNavigateLeft<cr>
tnoremap <silent> <M-j> <C-w>:TmuxNavigateDown<cr>
tnoremap <silent> <M-k> <C-w>:TmuxNavigateUp<cr>
tnoremap <silent> <M-l> <C-w>:TmuxNavigateRight<cr>
tnoremap <silent> <M-\> <C-w>:TmuxNavigatePrevious<cr>

set showcmd
set cmdheight=2
set laststatus=2
set backspace=indent,eol,start
set whichwrap+=<,>,h,l
set ignorecase
set smartcase
set ruler
set relativenumber "displays the relative number on the side
set showmatch
set incsearch   "move as we search
set hlsearch    "highlight the search results
set virtualedit=block
set comments=s1:/*,mb:\ *,elx:\ */
set wildmenu
set wildmode=list:longest,full
set wildignore=*.o,*~,*.gch,*.pyc,*.jpg,*.gif,*.png " Ignore compiled files
set ttyfast
set encoding=utf-8
set nobackup
set nowb
set noswapfile
" Uncomment below to make screen not flash on error
set vb t_vb=""
" removes 'press ENTER or type a command to continue'
set shortmess=atI
set linebreak

" use mouse to select
behave mswin

"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" => Auto commands
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

" Highlight line
augroup CursorLine
  au!
  au VimEnter,WinEnter,BufWinEnter * setlocal cursorline
  au WinLeave * setlocal nocursorline
augroup END

" shell edit mode
augroup ShellEdit " {
  au!
  au BufEnter /bb/data/tmp/bash-fc* set ft=sh
augroup END "}
